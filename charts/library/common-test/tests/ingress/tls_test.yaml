suite: ingress - tls test
templates:
  - common.yaml
release:
  name: test-release-name
  namespace: test-release-namespace
tests:
  - it: should pass with ingress created with tls secretName
    set:
      service:
        my-service:
          enabled: true
          primary: true
          ports:
            main:
              enabled: true
              primary: true
              port: 80
      ingress:
        my-ingress:
          enabled: true
          primary: true
          hosts:
            - host: test-host
              paths:
                - path: /test-path
            - host: other-test-host
              paths:
                - path: /other-test-path
          tls:
            - hosts:
                - test-host
              secretName: test-host-tls
    asserts:
      - documentIndex: &ingressDoc 1
        isKind:
          of: Ingress
      - documentIndex: *ingressDoc
        equal:
          path: spec.tls
          value:
            - hosts:
                - test-host
              secretName: test-host-tls
